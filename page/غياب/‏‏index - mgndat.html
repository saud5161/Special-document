<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نموذج غياب</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            text-align: right;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #fff;
        }
        .section {
            margin-bottom: 20px;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }
        .section h2 {
            margin-top: 0;
        }
        label {
            display: block;
            margin: 10px 0 5px;
        }
        input[type="text"],
        select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        input[disabled],
        select[disabled] {
            background-color: #e9e9e9;
            cursor: not-allowed;
        }
        button {
            display: inline-block;
            width: 100%;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        button:disabled {
            background-color: #ddd;
            cursor: not-allowed;
        }
        button:hover:enabled {
            background-color: #45a049;
        }
        .error-message {
            color: red;
            text-align: center;
            display: none;
        }
        .editable {
            border: none;
            outline: none;
            background: none;
            resize: none;
        }
        .note {
            color: green;
            font-size: small;
        }
        .skip-container {
            display: flex;
            align-items: center;
            font-size: small;
            margin-top: 10px;
        }
        .record {
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            background-color: #fefefe;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 class="editable" contenteditable="true">نموذج غياب</h1>

    <!-- إضافة حقل اختيار عدد المحضر -->
    <div class="section">
        <label for="recordCount">عدد محضر الغياب:</label>
        <select id="recordCount" name="recordCount" required>
            <option value="">اختر عدد المحاضر</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
    </div>

    <div class="section">
        <h2 class="editable" contenteditable="true">معلومات التاريخ</h2>
        <span id="timeNote" class="note" style="display: none;">التاريخ وقت الاستلام</span>
        <label for="hijriDate">التاريخ (هجري):</label>
        <input type="text" id="hijriDate" name="hijriDate" required disabled>
        <label for="weekday">اليوم (أسبوعي):</label>
        <input type="text" id="weekday" name="weekday" required disabled>
    </div>

    <div class="section">
        <h2 class="editable" contenteditable="true">المناوبة والصالة</h2>
        <label for="department">المناوبة/ الشعبة:</label>
        <select id="department" name="department" required disabled>
            <option value="">اختر المناوبة</option>
            <option value="أ">أ</option>
            <option value="ب">ب</option>
            <option value="ج">ج</option>
            <option value="د">د</option>
        </select>
        <label for="room">رقم الصالة:</label>
        <select id="room" name="room" required disabled>
            <option value="">اختر رقم الصالة</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
        </select>
    </div>

    <div class="section">
        <h2 class="editable" contenteditable="true">معلومات الاسم والرتبة</h2>
        <div id="nameRankContainer">
            <!-- حقول الاسم والرتبة ستُضاف هنا ديناميكيًا -->
        </div>
    </div>

    <div class="section">
        <h2 class="editable" contenteditable="true">معلومات ضابط الصالة</h2>
        <label for="officerName">اسم ضابط الصالة:</label>
        <input type="text" id="officerName" name="officerName" required list="officerNameList" disabled>
        <datalist id="officerNameList">
            <!-- قائمة أسماء الضباط -->
            <option value="أحمد عادل الزهراني">
    <option value="أحمد علي العمري">
    <option value="عبدالله سعد المطيري">
    <option value="عبدالله محمد البقمي">
    <option value="عبدالله مازن المطيري">
    <option value="عبدالعزيز عبدالله آل مطلق">
    <option value="عبدالعزيز عبدالله الحارثي">
    <option value="عبدالرحمن راشد البنيه">
    <option value="عبدالمجيد دحيم العتيبي">
    <option value="عادل بنيدر المطيري">
    <option value="عمر سعد المطيري">
    <option value="فايز سعيد الشهراني">
    <option value="فهد علي المالكي">
    <option value="فهد حامد القحطاني">
    <option value="فيصل عبدالإله الهرف">
    <option value="فيصل عبدالله الكريديس">
    <option value="فيصل سعد الضفيان">
    <option value="فيصل موسى المطيري">
    <option value="فيصل منصور السعيد">
    <option value="فواز عبدالعزيز الخليفة">
    <option value="خالد عبدالله الحسين">
    <option value="حمود علي الباهلي">
    <option value="يزيد مشعل العتيبي">
    <option value="سعود فراج السهلي">
    <option value="سعود محمد ال جبل">
    <option value="سعد عبدالعزيز الخشلان">
    <option value="صالح إبراهيم السالم">
    <option value="صالح محمد الحميدان">
    <option value="نايف سلمان المطيري">
    <option value="محمد عبدالله الرفاع">
    <option value="مالك أحمد العنقري">
    <option value="ماجد عبدالعزيز السحيم">
    <option value="معاذ ظفر آل دريس">
    <option value="مهند فهد ال جلده">
    <option value="ناصر دغش السبيعي">
    <option value="تركي عبدالله الزهراني">
    <option value="تركي عبدالله الشبيلي">
    <option value="عادل بنيدر المطيري">
    <option value="عبدالله سعد المطيري">  
        </datalist>
      <label for="officerRank">رتبة ضابط الصالة:</label>
<select id="officerRank" name="officerRank" required disabled>
    <option value="">اختر الرتبة</option>
    <option value="ملازم/">ملازم/</option>
    <option value="ملازم اول/">ملازم اول/</option>
    <option value="نقيب/">نقيب/</option>
    <option value="رائد/">رائد/</option>
    <option value="مقدم/">مقدم/</option>
    <option value="عقيد/">عقيد/</option>
</select>


    <button type="button" id="submitButton" onclick="submitForm()" disabled>تنفيذ</button>
    
    
    <div class="skip-container">
        <input type="checkbox" id="skipValidation">
        <label for="skipValidation">تخطي</label>
    </div>
    <p class="error-message" id="errorMessage">الرجاء تعبئة جميع الخانات</p>
</div>

<script>
    // قوائم الأسماء حسب القسم والصالة
        //مناوبة ا صالة 3 

    const namesA2 = ["مبارك محمد مبارك البليم", "زيد عبدالله زيد التميمي", "سالم مسفر فالح القحطاني", "مسفر مجهار مسفر الدوسري", "باسم حمادي زولي", "العنود محمد العرفج", "عمشاء خزيم السهلي", "محمد إبراهيم بن منيف", "بندر إبراهيم محمد حبيبي", "محمد عبدالله سعد العمري", "إبراهيم حمود هاشم الغريس", "مانع سالم الشهراني", "سعود علي حاضر الخثعمي", "مشاعل حسن الزهراني", "الهنوف محمد الشهراني", "نواف محمد حسن المالكي", "أحمد ناصر يحي الودعاني", "أحمد عيد سعيد أبالعلاء", "إبراهيم يحيى أحمد بعيطي", "جازم موسى صالح العنزي", "علي خلف مثني الحربي", "إبراهيم خالد إبراهيم العقيلي", "وليد عبدالرحمن أحمد الشهري", "تركي صالح راشد العتيبي", "سلطان عبدالله علي الشهري", "مطر سميح محمد النفيعي", "عبدالرحمن أحمد الغامدي", "محمد طراد عبدالله الاسمري"];
        //مناوبة ب صالة 3 

    const namesB2 = ["عبدالمجيد سلطان المغيري", "بريك مبرك جود الله المطيري", "فهد مملوح الرشيدي", "هيثم عبدالله العثيم", "نوف عبدالعزيز الدوسري", "نجود صالح الصيعري", "رنا مسفر الوادعي", "ريما سعد القحطاني", "نوره نايف الرشيدي", "عبدالعزيز عواد مناور الحربي", "خلود محمد الخثعمي", "انوار عبدالله الحجيلان", "رندا رابح الحربي", "سناء عبدالله القرني", "نوف حمد الظهير", "وفاء محمد الشهري", "مرام سعيد الشمراني", "عبدالله أحمد سعد عسيري", "عبدالعزيز محسن الخضران", "نواف ناصر علي العجمي", "راشد حمدان محمد الشمري", "عبدالسلام فلاح مدلول الشمري", "أديب غيث عواد الجهني", "عبدالله محمد عبدالله الزهراني", "يوسف محمد صالح العمري", "صالح خلف الرشيدي", "سلطان سلامه العليمي"];

    //مناوبة ج صالة 3 

    const namesC2 = ["أحمد مهل سعد العتيبي", "احمد مبارك ناصر الدوسري", "عبدالهادي مويسان العتيبي", "محمد علي جراد الشهري", "نواف عليان فنيس العتيبي", "فواز طيب العتيبي", "فارس عبيد العتيبي", "جمله نجاء المطيري", "شروق عبدالرحمن الفالح", "سلمى عيسى عسيري", "سحر سليم العطوي", "ايمان سلمان الشغرود", "ابرار محمد الهدهدي", "خلود سند المطيري", "عبير سلطان البقمي", "خلود سليمان المطيري", "ثامر منير قزعان العتيبي", "رايد سويلم فهاد الشمري", "هتاف معيض المطيري", "نوف صياح العنزي", "شروق نزال الحربي", "أنهار منصور الحمداني", "خالد عبدالله عبدالرحمن الشمري", "يوسف ماجد جزاع الشمري", "حسين سلطان حمود العتيبي", "طلال عايد عيد المطيري", "عبدالكريم صالح المطيري", "خالد عبدالرحمن الشهري"];
        //مناوبة د صالة 3 

    const namesD2 = ["عبدالله فهد بداح الدوسري", "محمد حمد العتيبي", "عبدالرحمن طراد حامد الشمري", "محمد معتاد عبدالرحمن العتيبي", "سعود فهد عبود العتيبي", "إبراهيم عبدالله المباركي", "فيصل عيد عساف العتيبي", "حسن مطلق خلف الشمري", "تركي سعد يعقوب العتيبي", "وليد جمعان مبارك ال حفيان", "ماجد سعيد عبدالرحمن العتيبي", "فاطمة محمد البارقي", "أماني علي الحازمي", "تماني علي البلوي", "سعيد جابر ناصر العايذي", "سليمان مشعل باروك العتيبي", "محمد صالح سليمان الدخيل الله", "عبدالله أحمد عبدالله الزهراني", "أيوب عبدالعزيز فهد الدايل", "محمد أسامه محمد العتيق", "سعد مريح مطير الشمري", "ياسر ذعار محمد العتيبي", "عبدالرحمن برجس عبدالرحمن المطيري", "يوسف فهد خلف الرشيدي", "عبدالرحمن عبدالله هادي الرشيدي", "عيسى عزوز محسن الحربي", "سعد سعيد القرني", "سعود محمد سعود الحجي"];

    //مناوبة ا صالة 4 

    const namesA3 = ["حاتم سليمان المطيري", "حاتم رحيم فارس العتيبي", "دخيل عوض دخيل المطيري", "ناهض مبارك عبدالله الدوسري", "حمود عبدالله حمود الحربي", "سعد سعود سعد العصيمي", "حصه مساعد المطيري", "بسمه عليان العتيبي", "نورة علي القحطاني", "هديل سلمان الشمري", "عبدالرحمن يحيى علي ابوصلام", "هاجد عوض هاجد المطيري", "عائشة مريف العديساني", "بيان عبدالرحمن العمري", "امل حسن علي الشامي", "سميرة أحمد معيني", "سارة إبراهيم الطشلان", "تماضر محمد المطيري", "محمد سامي حمود الحربي", "متعب علي صالح الرزيحي", "علي حسن حمد العماري", "نواف سلطان سعد التميمي", "أنس محمد عيسى الحربي", "سلطان بندر فرحان العتيبي", "عبدالمحسن نافل سعود السبيعي", "نايف عزيز نايف المطيري", "مطلق فالح منيع السهلي", "خالد هداف مبارك القحطاني", "سلمان موسى سلمان البلوي"];
//مناوبة ب صالة 4 

    const namesB3 = ["عليثه جروان عليثه الروقي", "محسن ذيب شليل العتيبي", "محمود علي غرمان العمري", "فيصل دخيل القحطاني", "أمينة ناصر القحطاني", "اريج محمد الحربش", "عقاب ناير بدر المطيري", "احمد صالح علان الغامدي", "حزام حمود محمد العصيمي", "فايز عائض عبدالله الغامدي", "فهد مسفر حسن ال فهاد", "فوزية حسن الزهراني", "نوره ناصر المبرد", "صالحة علي الاسمري", "فاطمة جابر محمد عبدلي", "مها محمد حمود الجراد", "غدير ابراهيم العفيصان", "أميرة مبارك الغامدي", "هند صالح العزام", "سعد محمد مجزع الحارثي", "اسامه حمد احمد شنيمر", "محمد حمود حسين الجدعاني", "يوسف ناصر ساير المطيري", "عبدالله مسعود خلف الدوسري", "عبدالرحمن محمد عوض الحربي", "محمد علي محمد فقيهي", "عبدالعزيز دباس عبدالله العتيبي", "سلمان محمد هندي البقمي", "تركي محمد خلف العنزي", "عيسى حمد جعيبر العنزي", "عبدالعزيز مصلح آل عيد", "عيسى مرزوق لافي المطيري"];
//مناوبة ج صالة 4 

const namesC3 = ["عبدالعزيز حميد باتل الرشيدي", "ماجد عشق بركة العتيبي", "مشاري سعود عواض المطيري", "عبدالعزيز فهد غازي العتيبي", "محمد حمود دباشي العلياني", "نايف سعد محمد القحطاني", "عايشة جوعان العنزي", "ريم هادي الصيعري", "شوق ناصر الشهراني", "ريمه عارف ال محمد", "نوره عبدالله العتيبي", "عواطف ذعار العتيبي", "عبدالله محمد عبدالله الشمراني", "عبدالله فيحان مضحي العتيبي", "تهاني سعود العتيبي", "شاديه حسن احمد", "نوف فيصل الشمري", "مي محمد عبيد", "امل عبدالله سهلي", "ريم علي الشهري", "رزان سالم القحطاني", "أسماء عبدالله القرني", "أحمد يحي حماد المالكي", "فهد حمود الحميدي العتيبي", "محمد غازي سعود العتيبي", "خالد محمد فهد المطيري", "زيد عوض نافع المطيري", "محمد مساعد سلطان السلطان", "عبدالله حسن علي عسيري", "فيصل مرزوق رابح الرحيلي", "تركي مشعان نايض العتيبي", "عالي علي الزهراني", "يحيى عسران موسى فقيهي"]; 


//مناوبة د صالة 4 
    const namesD3 = 
     ["أحمد نايف صالح المطيري", "محمد مناحي عبدالله القحطاني", "وليد عواض محمد الحربي", "أحمد سلمان الرشيدي", "ناصر شليويح فالح الدوسري", "زياد مبارك براك الرشيدي", "نبيل أحمد عبده مسرحي", "فهد فلاح مرزوق السبيعي", "زينب فهد الحربي", "ريهام حمود حماد البلوي", "سجى علي الوهيبي", "محمد شاكر مطني الشمري", "أبتهال غازي المطيري", "روابي عبدالعزيز الخميس", "نورة سلطان السلطان", "نهى عيد المطيري", "ريم فهد الحربي", "امنه سعد القحطاني", "حصه صالح العتيبي", "خلود خالد العتيبي", "سامر سعدي فلاح الحربي", "ماجد سفر عالي الحارثي", "تركي علي سعد القحطاني", "متعب فلاح فالح العازمي", "فيصل علي حسين قحطاني", "محمد أحمد محمد قصادي", "أحمد علي عبدالله العبد", "محمد مشعل ابجاد العتيبي", "محمد مطر حمدان السعدي", "عبدالعزيز محمد الزهراني", "محمد عواض سارح القرني", "عبير ماجد العوفي"];
    
    //مناوبة ا صالة 1 

     const namesA4 = ["حسين محمد سعود القحطاني", "فالح مبارك حضرم الدوسري", "عبدالله هادي سابر آل فهاد", "ماجد عبدالعزيز العتيبي", "سعيد صالح شاجع العجمي", "ايمان فهد بن ثنيان", "بلغيث علي محمد البارقي", "خالد عبدالكريم محمد الزهراني", "فايز غازي عجب الحربي", "سلمان محمد احمد الزهراني", "ثاري اديهم ثاري الرشيدي", "جواهر إبراهيم الحميد", "عائشة خالد المطيري", "غرام عائض الشمراني", "حنان سعد القحطاني", "وداد محمد سويعد المطيري", "فاطمة عبدالرحمن الشهري", "علياء منير المطيري", "زياد محمد علي الشهري", "عمر ساري سالم الفهيقي", "سلمان عايد عيد الحويطي", "يحيى عبدالله يحي الزهراني", "عبدالله بندر عميد الحربي", "مشعل صالح عبدالله الشويمان", "مساعد يوسف أحمد عسيس", "حامد مجزع عيد العنزي", "هاني محمد أحمد هزازي", "ثامر محمد بشير العطوي", "محمد خالد موسى الزيكان", "محمد عجب عايض العتيبي", "حسام عالي حضرم الحربي", "محمود فاطم المطيري", "إبراهيم ناصر الرشيدي"];
        //مناوبة ب صالة 1 

     const namesB4 = ["جسار مفرح العتيبي", "عبدالمحسن محمد الشراري", "نايف ناصر عويض العتيبي", "هاله علي شعران", "وجدان محمد عيساوي", "وداد محمد منور المطيري", "جواهر سفر الغامدي", "عبدالقادر محمد سعيد الشهراني", "مشعل مفرح هليل الرشيدي", "يوسف زياد يوسف البيشي", "نوف احمد السريحي", "راما منصور القرني", "الهام أحمد الاحمري", "امل موسى العتيبي", "نجوى أحمد الزهراني", "الهنوف إبراهيم الرميح", "عبدالله محمد ظافر الشهري", "منيرة صالح القنصعي", "عبدالله علي غيثان الخثعمي", "عبدالعزيز محمد أحمد العضيب", "مازن محمد عيد الحويطي", "عبدالله خالد عبدالله العشره", "محمد عايض ربيع العتيبي", "عبدالمجيد حمود سمير الحربي", "محمد فرح عيد العنزي", "وائل عبدالعزيز برجس عنزي", "عبدالعزيز سعود عواض المطيري", "أيمن عبدالله مملوح الرشيدي", "مشاري عبدالله شارع العتيبي", "عبدالرحمن فهد عيد الحربي", "ناصر مفرح العتيبي", "نواف أحمد محمد كاملي", "غادة ناصر ال مرعي"];
    //مناوبة ج صالة 1 

   const namesC4 = ["حسين علي منصور العتيق", "مناحي هتاش منير المرشدي", "عيد محمد عيد القرني", "عبدالرحمن سند عتيق الشراري", "ظافر عايض سالم العمري", "فهد مبارك حضرم الدوسري", "ممدوح عائض العتيبي", "سميه منصور العتيبي", "مزنه فائز الاكلبي", "هديل عبدالله البويريد", "محسن مسعود مهدي علي", "عبدالله يحي عبدان الزهراني", "سلطان وهق علي السهلي", "عبدالعزيز أحمد علي الشهراني", "مسفر مترك مسفر الدوسري", "نوف سعد الرويس", "خلود عبدالله الشهراني", "ريم احمد عبدالرحمن", "فاطمة علي الحلافي", "نوره مسفر القحطاني", "ولاء خالد العمري", "الهنوف محمد الهويمل", "سهام دخيل الحربي", "عفاف خلف العنزي", "رندا سالم الحربي", "فارس صالح فارس الحربي", "خالد حسين محمد سهلي", "عبدالرحمن غازي عوض العمري", "محمد علي عايض الحارثي", "متعب ضبيان سويلم الطقطقي", "عبدالعزيز محمد ضيدان المطيري", "نايف بنيه الرشيدي", "فهد محمد ناصر ال بريك"];
        //مناوبة د صالة 1 

   const namesD4 = ["محمد معيوض حمود العتيبي", "رامي شقير المطيري", "محمد تميم مضحي الدوسري", "مساعد صالح محمد الطوب", "محمد ضاوي المطيري", "سعود عبدالله تركي السبيعي", "طلال محمد بخيت العتيبي", "غنيه ظافر سهلي", "ابتهال معيض القحطاني", "أريج يحيى معافا", "شايع عبدالله غانم القحطاني", "معاذ علي محمد الحبيب", "سلطان عبدالله نفوع الرشيدي", "مصعب حسن سعيد ال علوان", "عبدالله ضحيان هجود الحارثي", "مطلق فايز مطلق السلولي", "هاجر فهد العنزي", "منيفه صويلح العتيبي", "نرجس عيسى الدوسري", "بشائر محمد الفيفي", "مريم عبدالله الزهراني", "سامي ناشي ارضيان البقمي", "عبدالسلام فرحان عبدالعالي الحربي", "سالم علي سالم هليل", "عبدالعزيز عبدالله إبراهيم العريني", "محمد نياف موسم العتيبي", "حسين صايل محمد العجلان", "مقرن عبدالعزيز نور المطيري", "علي أحمد عبدالله الشهري", "عايد مساعد سعد المطيري", "سلمان أحمد عبدالله السويح", "شايع عبدالرحمن محمد العتيق", "ثامر منسي عقيل العنزي"];


    document.addEventListener("DOMContentLoaded", function() {
        const today = new Date();
        const options = { year: 'numeric', month: '2-digit', day: '2-digit' };

        const hours = today.getHours();
        if (hours >= 0 && hours < 6) {
            today.setDate(today.getDate() - 1);
            document.getElementById("timeNote").style.display = "block";
        }

        let formattedDate = today.toLocaleDateString('ar-SA', options).replace(/\d+/g, function(d) {
            return ('0' + d).slice(-2);
        }).replace(/\/(\d{2})\//g, '/$1/');
        document.getElementById("hijriDate").value = toArabicNumbers(formattedDate);
        document.getElementById("weekday").value = today.toLocaleDateString('ar-SA', { weekday: 'long' });

        // تمكين الحقول عند اختيار عدد المحضر
        document.getElementById("recordCount").addEventListener("change", function() {
            updateNameRankFields(this.value);
            enableFields(); // تمكين الحقول بناءً على اختيار عدد المحضر
            validateForm();
        });

        // تمكين قسم وصالة فقط بعد اختيار عدد المحضر
        document.getElementById("department").addEventListener("change", function() {
            updateNames();
            validateForm();
        });

        document.getElementById("room").addEventListener("change", function() {
            updateNames();
            validateForm();
        });

        // إضافة مستمعين لأحداث الإدخال والتحقق من صحة النموذج
        document.querySelectorAll('input, select').forEach(element => {
            element.addEventListener('input', validateForm);
            element.addEventListener('change', validateForm);
        });

        document.getElementById("skipValidation").addEventListener("change", function() {
            validateForm();
        });

        validateForm();
    });

    function toArabicNumbers(str) {
        return str.replace(/\d/g, d => '٠١٢٣٤٥٦٧٨٩'[d]);
    }

    function updateNames() {
        const department = document.getElementById("department").value;
        const room = document.getElementById("room").value;

        // تحديد المصفوفة المناسبة بناءً على القسم والصالة
        let names;
        switch (department) {
            case 'أ':
                names = room === '3' ? namesA2 : room === '4' ? namesA3 : room === '1' ? namesA4 : [];
                break;
            case 'ب':
                names = room === '3' ? namesB2 : room === '4' ? namesB3 : room === '1' ? namesB4 : [];
                break;
            case 'ج':
                names = room === '3' ? namesC2 : room === '4' ? namesC3 : room === '1' ? namesC4 : [];
                break;
            case 'د':
                names = room === '3' ? namesD2 : room === '4' ? namesD3 : room === '1' ? namesD4 : [];
                break;
            default:
                names = [];
        }

        // تحديث عناصر select الخاصة بالأسماء
        const recordCount = parseInt(document.getElementById("recordCount").value) || 0;
        for (let i = 1; i <= recordCount; i++) {
            const nameSelect = document.getElementById(`name${i}`);
            if (nameSelect) {
                nameSelect.innerHTML = '<option value="">اختر الاسم</option>'; // مسح الخيارات الحالية وإضافة الخيار الافتراضي
                names.forEach(name => {
                    const option = document.createElement("option");
                    option.value = name.trim(); // إزالة الفراغات الزائدة
                    option.textContent = name.trim();
                    nameSelect.appendChild(option);
                });
            }
        }
    }

    function updateNameRankFields(count) {
        const container = document.getElementById("nameRankContainer");
        container.innerHTML = ''; // مسح الحقول السابقة

        for (let i = 1; i <= count; i++) {
            const recordDiv = document.createElement("div");
            recordDiv.className = "record";

            // اسم
            const nameLabel = document.createElement("label");
            nameLabel.setAttribute("for", `name${i}`);
            nameLabel.textContent = `الاسم ${i}:`;
            recordDiv.appendChild(nameLabel);
            
            const nameSelect = document.createElement("select");
            nameSelect.id = `name${i}`;
            nameSelect.name = `name${i}`;
            nameSelect.required = true;
            nameSelect.disabled = true; // سيتم تمكينه عند اختيار المناوبة والصالة
            recordDiv.appendChild(nameSelect);
            // ربط الحدث بعد إضافة العناصر كاملة إلى DOM
nameSelect.addEventListener("change", function () {
    const selectedName = nameSelect.value.trim();
    if (personInfo[selectedName]) {
        rankSelect.value = personInfo[selectedName].rank;
        absenceSelect.value = personInfo[selectedName].absenceType;
    } else {
        rankSelect.value = "";
        absenceSelect.value = "";
    }
});

            // زر لإدخال الاسم يدويًا
const manualButton = document.createElement("button");
manualButton.type = "button";
manualButton.textContent = "في حال كان الاسم غير موجود اضغط هنا";
manualButton.style.margin = "5px 0";
manualButton.style.padding = "2px 5px"; // الزر نفسه صغير الحجم
manualButton.style.fontSize = "12px"; // حجم خط صغير
manualButton.style.backgroundColor = "#eee"; // خلفية فاتحة للزر
manualButton.style.border = "1px solid #ccc";
manualButton.style.borderRadius = "4px";
manualButton.style.cursor = "pointer";
manualButton.style.color = "black"; // لون الخط أسود
manualButton.style.fontWeight = "bold"; // الخط عريض
recordDiv.appendChild(manualButton);

// حقل إدخال يدوي مخفي مبدئيًا
const manualInput = document.createElement("input");
manualInput.type = "text";
manualInput.placeholder = "ادخل الاسم هنا";
manualInput.style.display = "none";
manualInput.style.marginBottom = "10px";
recordDiv.appendChild(manualInput);

// تفعيل الإدخال اليدوي عند الضغط على الزر
manualButton.addEventListener("click", function() {
    manualInput.style.display = "block";
    nameSelect.disabled = true;
    manualInput.focus();
});

// عند فقدان التركيز من الحقل اليدوي، إذا أدخل الاسم يُستخدم، وإذا تركه فارغ يرجع للوضع الطبيعي
manualInput.addEventListener("blur", function() {
    const enteredName = manualInput.value.trim();
    if (enteredName !== "") {
        const newOption = document.createElement("option");
        newOption.value = enteredName;
        newOption.textContent = enteredName;
        nameSelect.appendChild(newOption);
        nameSelect.value = enteredName; // تحديد الاسم الجديد تلقائيًا

        manualInput.style.display = "none";
        nameSelect.disabled = false;
        manualInput.value = ""; // مسح الحقل بعد الاستخدام (اختياري)
    } else {
        manualInput.style.display = "none";
        nameSelect.disabled = false;
    }
});



            // رتبة
            const rankLabel = document.createElement("label");
            rankLabel.setAttribute("for", `rank${i}`);
            rankLabel.textContent = `الرتبة ${i}:`;
            recordDiv.appendChild(rankLabel);

            const rankSelect = document.createElement("select");
            rankSelect.id = `rank${i}`;
            rankSelect.name = `rank${i}`;
            rankSelect.required = true;
            rankSelect.disabled = true;

            const defaultOption = document.createElement("option");
            defaultOption.value = "";
            defaultOption.textContent = "اختر الرتبة";
            rankSelect.appendChild(defaultOption);

            const ranks = ["جندي", "جندي أول", "عريف", "وكيل رقيب", "رقيب", "رقيب اول", "رئيس رقباء"];
            ranks.forEach(rank => {
                const option = document.createElement("option");
                option.value = rank;
                option.textContent = rank;
                rankSelect.appendChild(option);
            });
            
            recordDiv.appendChild(rankSelect);

            // نوع المحضر
            const absenceLabel = document.createElement("label");
            absenceLabel.setAttribute("for", `absenceType${i}`);
            absenceLabel.textContent = `نوع المحضر ${i}:`;
            recordDiv.appendChild(absenceLabel);

            const absenceSelect = document.createElement("select");
            absenceSelect.id = `absenceType${i}`;
            absenceSelect.name = `absenceType${i}`;
            absenceSelect.required = true;
            absenceSelect.disabled = true;

            const absenceDefaultOption = document.createElement("option");
            absenceDefaultOption.value = "";
            absenceDefaultOption.textContent = "اختر نوع المحضر";
            absenceSelect.appendChild(absenceDefaultOption);

            const absenceTypes = ["مجندات", "أفراد"];
            absenceTypes.forEach(type => {
                const option = document.createElement("option");
                option.value = type;
                option.textContent = type;
                absenceSelect.appendChild(option);
            });

            recordDiv.appendChild(absenceSelect);

            // رقم الصادر
            const outgoingLabel = document.createElement("label");
            outgoingLabel.setAttribute("for", `outgoingNumber${i}`);
            outgoingLabel.textContent = `رقم الصادر ${i}:`;
            recordDiv.appendChild(outgoingLabel);

            const outgoingInput = document.createElement("input");
            outgoingInput.type = "text";
            outgoingInput.id = `outgoingNumber${i}`;
            outgoingInput.name = `outgoingNumber${i}`;
            outgoingInput.required = true;
            outgoingInput.disabled = true;
            recordDiv.appendChild(outgoingInput);

            container.appendChild(recordDiv);
        }

        // عند تغيير المناوبة أو الصالة، يتم تحديث الأسماء وتمكين حقول الاسم والرتبة
        document.getElementById("department").addEventListener("change", function() {
            toggleNameFields(true);
            updateNames();
            validateForm();
        });

        document.getElementById("room").addEventListener("change", function() {
            toggleNameFields(true);
            updateNames();
            validateForm();
        });
    }

    function toggleNameFields(enable) {
        const recordCount = parseInt(document.getElementById("recordCount").value) || 0;
        for (let i = 1; i <= recordCount; i++) {
            const nameSelect = document.getElementById(`name${i}`);
            const rankSelect = document.getElementById(`rank${i}`);
            const absenceSelect = document.getElementById(`absenceType${i}`);
            const outgoingInput = document.getElementById(`outgoingNumber${i}`);

            if (nameSelect) nameSelect.disabled = !enable;
            if (rankSelect) rankSelect.disabled = !enable;
            if (absenceSelect) absenceSelect.disabled = !enable;
            if (outgoingInput) outgoingInput.disabled = !enable;
        }
    }

    function validateForm() {
        const recordCount = parseInt(document.getElementById("recordCount").value) || 0;
        let allFilled = true;

        // التحقق من الحقول الأخرى (التاريخ، اليوم، المناوبة، الصالة، ضابط الصالة، رتبة ضابط الصالة)
        const requiredFields = document.querySelectorAll('input[required], select[required]');
        requiredFields.forEach(input => {
            if (input.disabled) return;
            if (input.value.trim() === '') {
                allFilled = false;
            }
        });

        // التحقق من حقول الاسم، الرتبة، نوع المحضر، ورقم الصادر لكل سجل
        for (let i = 1; i <= recordCount; i++) {
            const name = document.getElementById(`name${i}`);
            const rank = document.getElementById(`rank${i}`);
            const absenceType = document.getElementById(`absenceType${i}`);
            const outgoingNumber = document.getElementById(`outgoingNumber${i}`);

            if (name && name.value.trim() === '') {
                allFilled = false;
            }
            if (rank && rank.value.trim() === '') {
                allFilled = false;
            }
            if (absenceType && absenceType.value.trim() === '') {
                allFilled = false;
            }
            if (outgoingNumber && outgoingNumber.value.trim() === '') {
                allFilled = false;
            }
        }

        const submitButton = document.getElementById('submitButton');
        const errorMessage = document.getElementById('errorMessage');
        const skipValidation = document.getElementById('skipValidation').checked;

         submitButton.disabled = false;
        errorMessage.style.display = 'none';
    }

    function submitForm() {
        const hijriDate = toArabicNumbers(document.getElementById('hijriDate').value);
        const weekday = document.getElementById('weekday').value;
        const department = document.getElementById('department').value;
        const room = document.getElementById('room').value;
        const officerName = document.getElementById('officerName').value;
        const officerRank = document.getElementById('officerRank').value;

        const recordCount = parseInt(document.getElementById("recordCount").value) || 1;

        for (let i = 1; i <= recordCount; i++) {
            const nameSelect = document.getElementById(`name${i}`);
const recordDiv = nameSelect.closest('.record');
const manualInput = recordDiv.querySelector("input[type='text']");

const name = (manualInput && manualInput.style.display === "block" && manualInput.value.trim() !== "")
    ? manualInput.value.trim()
    : nameSelect.value;
            const rank = document.getElementById(`rank${i}`).value;
            const absenceType = document.getElementById(`absenceType${i}`).value;
            const outgoingNumber = document.getElementById(`outgoingNumber${i}`).value;

            const fullOutgoingNumber = `${outgoingNumber} / م ${department} سفر ${room}`;

            const url = `result.html?absenceType=${encodeURIComponent(absenceType)}&hijriDate=${encodeURIComponent(hijriDate)}&weekday=${encodeURIComponent(weekday)}&department=${encodeURIComponent(department)}&room=${encodeURIComponent(room)}&name=${encodeURIComponent(name)}&rank=${encodeURIComponent(rank)}&officerName=${encodeURIComponent(officerName)}&officerRank=${encodeURIComponent(officerRank)}&outgoingNumber=${encodeURIComponent(fullOutgoingNumber)}`;

            window.open(url, '_blank'); // فتح صفحة جديدة لكل محضر
        }
    }

    function enableFields() {
        // تمكين الحقول الأساسية
        const department = document.getElementById("department");
        const room = document.getElementById("room");
        const hijriDate = document.getElementById("hijriDate");
        const weekday = document.getElementById("weekday");
        const officerName = document.getElementById("officerName");
        const officerRank = document.getElementById("officerRank");

        if (document.getElementById("recordCount").value !== "") {
            department.disabled = false;
            room.disabled = false;
            hijriDate.disabled = false;
            weekday.disabled = false;
            officerName.disabled = false;
            officerRank.disabled = false;

            // تمكين حقول الاسم والرتبة ونوع المحضر ورقم الصادر لكل سجل
            const recordCount = parseInt(document.getElementById("recordCount").value) || 0;
            for (let i = 1; i <= recordCount; i++) {
                const name = document.getElementById(`name${i}`);
                const rank = document.getElementById(`rank${i}`);
                const absenceType = document.getElementById(`absenceType${i}`);
                const outgoingNumber = document.getElementById(`outgoingNumber${i}`);

                if (name) name.disabled = false;
                if (rank) rank.disabled = false;
                if (absenceType) absenceType.disabled = false;
                if (outgoingNumber) outgoingNumber.disabled = false;
            }
        }
    }


const officerRanks = {
    "فواز عبدالعزيز الخليفة": "ملازم اول/",
    "جابر فتنان الحربي": "ملازم اول/",
    "فيصل عبدالإله الهرف": "ملازم اول/",
    "فهد حامد القحطاني": "ملازم اول/",
    "فيصل منصور السعيد": "ملازم اول/",
    "عبدالعزيز عبدالله آل مطلق": "ملازم اول/",
    "مالك أحمد العنقري": "ملازم اول/",
    "عبدالرحمن راشد البنيه": "ملازم اول/",
    "يزيد مشعل العتيبي": "ملازم اول/",
    "عبدالإله ضيف الله بن غميض": "ملازم اول/",
    "فيصل سعد الضفيان": "ملازم اول/",
    "اسامه راشد المشوح": "ملازم اول/",
    "فهد علي المالكي": "ملازم اول/",
    "سعد عبدالعزيز الخشلان": "ملازم اول/",
    "مهند فهد ال جلده": "ملازم اول/",
    "عبدالعزيز عبدالله الحارثي": "ملازم اول/",
    "تركي عبدالله الزهراني": "ملازم اول/",
    "الريان عبدالله الهويمل": "ملازم اول/",
    "عادل بنيدر": "ملازم اول/",
    "معاذ ظفر آل دريس": "ملازم اول/",
    "صالح إبراهيم السالم": "ملازم اول/",
    "خالد عبدالله الحسين": "ملازم اول/",
    "عبدالله مازن المطيري": "ملازم اول/",

    "سعود محمد ال جبل": "نقيب/",
    "فيصل موسى المطيري": "نقيب/",
    "ماجد عبدالعزيز السحيم": "نقيب/",
    "عبدالله سعد المطيري": "نقيب/",
    "سعود فراج السهلي": "نقيب/",
    "أحمد علي العمري": "نقيب/",

    "حمود علي الباهلي": "ملازم اول/",
    "فيصل عبدالله الكريديس": "ملازم اول/",
    "أحمد عادل الزهراني": "ملازم اول/",
    "صالح محمد الحميدان": "ملازم اول/",
    "عبدالمجيد دحيم العتيبي": "ملازم اول/",
    "تركي عبدالله الشبيلي": "ملازم اول/",
    "عبدالله محمد البقمي": "ملازم اول/",
    "محمد عبدالله الرفاع": "ملازم اول/",
    "نايف سلمان المطيري": "ملازم اول/",
    "فايز سعيد الشهراني": "ملازم اول/",
    "عمر سعد المطيري": "ملازم اول/",
    "ناصر دغش السبيعي": "ملازم اول/"
};


document.addEventListener("DOMContentLoaded", function () {
    const officerNameInput = document.getElementById("officerName");
    const officerRankInput = document.getElementById("officerRank");

    officerNameInput.addEventListener("change", function () {
        const selectedName = officerNameInput.value.trim();
        if (officerRanks[selectedName]) {
            officerRankInput.value = officerRanks[selectedName]; // يضع الرتبة كاملة مثل "ملازم أول/"
        } else {
            officerRankInput.value = ""; // مسح الحقل إذا الاسم غير معروف
        }
    });
});
const personInfo = {
    "عبدالعزيز حميد باتل الرشيدي": { rank: "رئيس رقباء", absenceType: "أفراد" },
    "ماجد عشق بركة العتيبي": { rank: "وكيل رقيب", absenceType: "أفراد" },
    "مشاري سعود عواض المطيري": { rank: "وكيل رقيب", absenceType: "أفراد" },
    "عبدالعزيز فهد غازي العتيبي": { rank: "وكيل رقيب", absenceType: "أفراد" },
    "محمد حمود دباشي العلياني": { rank: "عريف", absenceType: "أفراد" },
    "نايف سعد محمد القحطاني": { rank: "عريف", absenceType: "أفراد" },
    "عايشة جوعان العنزي": { rank: "عريف", absenceType: "مجندات" },
    "ريم هادي الصيعري": { rank: "عريف", absenceType: "مجندات" },
    "شوق ناصر الشهراني": { rank: "عريف", absenceType: "مجندات" },
    "سفره ظافر الشهراني": { rank: "عريف", absenceType: "مجندات" },
    "ريمه عارف ال محمد": { rank: "عريف", absenceType: "مجندات" },
    "حسن محمد أبو طالب": { rank: "جندي أول", absenceType: "أفراد" },
    "عبدالله محمد عبدالله الشمراني": { rank: "جندي أول", absenceType: "أفراد" },
    "عبدالله فيحان مضحي العتيبي": { rank: "جندي أول", absenceType: "أفراد" },
    "سلمان عشوي سمر الرويلي": { rank: "جندي أول", absenceType: "أفراد" },
    "تهاني سعود العتيبي": { rank: "جندي أول", absenceType: "مجندات" },
    "شاديه حسن احمد": { rank: "جندي أول", absenceType: "مجندات" },
    "نوف فيصل الشمري": { rank: "جندي أول", absenceType: "مجندات" },
    "مي محمد عبيد": { rank: "جندي أول", absenceType: "مجندات" },
    "امل عبدالله سهلي": { rank: "جندي أول", absenceType: "مجندات" },
    "ريم علي الشهري": { rank: "جندي أول", absenceType: "مجندات" },
    "رزان سالم القحطاني": { rank: "جندي أول", absenceType: "مجندات" },
    "أحمد يحي حماد المالكي": { rank: "جندي", absenceType: "أفراد" },
    "شايع عبدالرحمن محمد العتيق": { rank: "رقيب", absenceType: "أفراد" },
    "سعود محمد سعود الحجي": { rank: "وكيل رقيب", absenceType: "أفراد" },
    "خالد عبدالرحمن الشهري": { rank: "عريف", absenceType: "أفراد" },
 "ممدوح عائض العتيبي": { rank: "عريف", absenceType: "أفراد" },
  "عبد الله يحي عيدان الزهراني": { rank: "جندي أول", absenceType: "أفراد" },
  "محسن مسعود مهدي علي": { rank: "جندي أول", absenceType: "أفراد" },
  "عبد العزيز طريخم خمخم العنزي": { rank: "جندي أول", absenceType: "أفراد" },
  "سهام دخيل الحربي": { rank: "جندي أول", absenceType: "مجندات" },
  "ريم احمد عبدالرحمن": { rank: "جندي أول", absenceType: "مجندات" },
  "الهنوف محمد الهويمل": { rank: "جندي أول", absenceType: "مجندات" },
  "فهد مبارك حضرم الدوسري": { rank: "عريف", absenceType: "أفراد" },
  "حسين علي منصور ال عتيق": { rank: "وكيل رقيب", absenceType: "أفراد" },
  "عيد محمد عيد القرني": { rank: "عريف", absenceType: "أفراد" },
  "عبد الرحمن سند عتيق الشراري": { rank: "عريف", absenceType: "أفراد" },
  "نوف سعد الرويس": { rank: "جندي أول", absenceType: "مجندات" },
  "عبد العزيز أحمد علي الشهراني": { rank: "جندي أول", absenceType: "أفراد" },
  "مسفر مترك مسفر الدوسري": { rank: "جندي أول", absenceType: "أفراد" },
  "خلود عبد الله الشهراني": { rank: "جندي أول", absenceType: "مجندات" },
  "سفره نوار العصيمي": { rank: "جندي أول", absenceType: "مجندات" },
  "عبد العزيز عبيد طامي الحربي": { rank: "جندي أول", absenceType: "أفراد" },
  "ظافر عايض سالم العمري": { rank: "عريف", absenceType: "أفراد" },
  "سميه منصور العتيبي": { rank: "عريف", absenceType: "مجندات" },
  "منى محمد الرشيدي": { rank: "جندي أول", absenceType: "مجندات" },
  "سلطان وهق علي السهلي": { rank: "جندي أول", absenceType: "أفراد" },
  "رندا سالم الحربي": { rank: "جندي أول", absenceType: "مجندات" },
  "سماهر سعد الصاعدي": { rank: "جندي أول", absenceType: "مجندات" },
  "مناحي هتاش منير المرشدي": { rank: "وكيل رقيب", absenceType: "أفراد" },
  "عيسى عزوز محسن الحربي": { rank: "رئيس رقباء", absenceType: "أفراد" },
  "عبدالعزيز مصلح ال عيد": { rank: "وكيل رقيب", absenceType: "أفراد" },
   "أحمد يحي حماد المالكي": { rank: "جندي", absenceType: "أفراد" },
  "فهد حمود الحميدي العتيبي": { rank: "جندي", absenceType: "أفراد" },
  "محمد غازي سعود العتيبي": { rank: "جندي", absenceType: "أفراد" },
  "خالد محمد فهد المطيري": { rank: "جندي", absenceType: "أفراد" },
  "زيد عوض نافع المطيري": { rank: "جندي", absenceType: "أفراد" },
  "محمد مساعد سلطان السلطان": { rank: "جندي", absenceType: "أفراد" },
  "عبدالله حسن علي عسيري": { rank: "جندي", absenceType: "أفراد" },
  "فيصل مرزوق رابح الرحيلي": { rank: "جندي", absenceType: "أفراد" }
  
};


</script>

</body>
</html>
